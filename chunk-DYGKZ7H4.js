import{c as B,d as Q,e as Z}from"./chunk-I3URWWNZ.js";import{C as re,G,I as le,J as L,K as se,L as de,N as V,O as ce,P as R,Q as j,R as W,S as Y,U as z,V as q,X as me,Y as ue,Z as pe,ea as U,fa as H,ka as he,la as xe,ma as ge,na as Ce,p as D,q as P,qa as J,r as N,ra as K,s,t as T,u as k,v as ne,w as A,x as f,xa as fe,y as O,z as I,za as X}from"./chunk-7642NXWV.js";import{Bb as v,Cb as y,Db as w,Fb as F,Gb as u,Oa as i,Pa as g,Za as b,aa as x,cb as $,eb as o,fa as _,g as h,gc as ae,hb as ie,jb as n,jc as E,kb as r,lb as c,mb as S,nb as M,pb as p,qb as oe,yb as C}from"./chunk-QYEXLL56.js";var ee=()=>({"aria-label":"Checked"}),Ee=()=>({"aria-label":"With Spin And Buttons"}),Be=()=>({"aria-label":"Product"}),Pe=()=>({width:"100%"}),Ne=()=>({"aria-label":"description"});function Te(m,te){if(m&1&&c(0,"dx-tag-box",30),m&2){let a=oe().$implicit;ie(u(6,Pe)),o("value",a.data.cursosPrevs)("disabled",!0)("maxDisplayedTags",1)("inputAttr",u(7,Ne))}}function ke(m,te){if(m&1&&(n(0,"div"),$(1,Te,1,8,"dx-tag-box",29),r()),m&2){let a=te.$implicit;i(),o("ngIf",a.data.cursosPrevs.length>0)}}var ve=(()=>{class m extends Z{constructor(a,e){super(),this._service=a,this._alert=e,this.hasLimit=!1,this.hasPreviewCourse=!1,this.coursesSource=[],this.courseForm=x(f).group({id:new s(0),courseName:new s("",[D.required]),courseDescription:new s(""),hasLimit:new s(!1),limit:new s(0),isActive:new s(!0),hasPreviewCourse:new s(!1),cursosPrev:new s([])})}ngOnInit(){return h(this,null,function*(){this._service.getCourses().then(a=>{console.log(a),this.coursesSource=a.data})})}onSelection(a){let e=a.data,t=e.cursosPrevs.map(l=>l.id);this.courseForm.patchValue(e),this.courseForm.patchValue({cursosPrev:t,hasPreviewCourse:t.length>0}),this.hasLimit=e.hasLimit,this.hasPreviewCourse=t.length>0}onSaveClick(){return h(this,null,function*(){let a=this.courseForm.value;console.log(a)})}resetForm(){this.hasPreviewCourse=!1,this.hasLimit=!1,this.courseForm.patchValue({id:0,courseName:"",courseDescription:"",hasLimit:!1,limit:0,cursosPrev:[]})}static{this.\u0275fac=function(e){return new(e||m)(g(Q),g(X))}}static{this.\u0275cmp=_({type:m,selectors:[["app-course"]],standalone:!0,features:[b,F],decls:40,vars:28,consts:[["icon","bookmarks","title","Grado",3,"sizeIcon"],[1,"form-course"],[3,"formGroup"],[1,"row"],["stylingMode","outlined","labelMode","floating","label","Nombre Grado","formControlName","courseName",2,"width","25%"],["stylingMode","outlined","labelMode","floating","label","Descripci\xF3n","formControlName","courseDescription",2,"width","25%","margin-left","10px"],[1,"label-check"],[1,"dx-check"],["formControlName","hasLimit",3,"valueChange","value","elementAttr"],["stylingMode","outlined","labelMode","floating","label","Limite","formControlName","limit",2,"margin-left","10px","width","100px","height","30px",3,"showSpinButtons","readOnly","inputAttr"],["formControlName","hasPreviewCourse",3,"valueChange","value","elementAttr"],["formControlName","cursosPrev","displayExpr","courseName","valueExpr","id","width","40%",2,"margin-left","10px",3,"items","searchEnabled","readOnly","inputAttr"],[1,"button"],["stylingMode","outlined","text","Guardar","type","default",2,"border","1px solid",3,"onClick","width","useSubmitBehavior"],["formControlName","isActive",3,"elementAttr"],[1,"grid"],["height","65vh",3,"onRowClick","dataSource"],[3,"visible","allowSearch"],[3,"visible"],["mode","virtual"],["fileName","fileName",3,"allowExportSelectedData","enabled"],["mode","single"],["dataField","courseName","dataType","string","caption","Nombre"],["dataField","courseDescription","dataType","string","caption","Nombre"],["dataField","cursosPrevs","dataType","string","caption","Grados requisitos","cellTemplate","requisito"],[4,"dxTemplate","dxTemplateOf"],["dataField","hasLimit","editorType","dxCheckBox","caption","\xBFTiene limite?","width","160"],["dataField","limit","dataType","number","caption","Limite","width","100"],["dataField","isActive","editorType","dxCheckBox","caption","\xBFActivo?","width","140"],["displayExpr","courseName",3,"value","disabled","maxDisplayedTags","inputAttr","style",4,"ngIf"],["displayExpr","courseName",3,"value","disabled","maxDisplayedTags","inputAttr"]],template:function(e,t){e&1&&(S(0),c(1,"app-container",0),n(2,"div",1)(3,"form",2)(4,"div",3),c(5,"dx-text-box",4)(6,"dx-text-box",5),r(),n(7,"div",3)(8,"div",6),C(9,"\xBFEstablecer limite de alumnos?"),r(),n(10,"div",7)(11,"dx-check-box",8),w("valueChange",function(d){return y(t.hasLimit,d)||(t.hasLimit=d),d}),r()(),c(12,"dx-number-box",9),r(),n(13,"div",3)(14,"div",6),C(15,"\xBFTiene cursos previos?"),r(),n(16,"div",7)(17,"dx-check-box",10),w("valueChange",function(d){return y(t.hasPreviewCourse,d)||(t.hasPreviewCourse=d),d}),r()(),c(18,"dx-tag-box",11),n(19,"div",12)(20,"dx-button",13),p("onClick",function(){return t.onSaveClick()}),r()()(),n(21,"div",3)(22,"div",6),C(23,"\xBFActivo?"),r(),n(24,"div",7),c(25,"dx-check-box",14),r()()()(),n(26,"div",15)(27,"dx-data-grid",16),p("onRowClick",function(d){return t.onSelection(d)}),c(28,"dxo-header-filter",17)(29,"dxo-filter-row",18)(30,"dxo-scrolling",19)(31,"dxo-export",20)(32,"dxo-selection",21)(33,"dxi-column",22)(34,"dxi-column",23),n(35,"dxi-column",24),$(36,ke,2,1,"div",25),r(),c(37,"dxi-column",26)(38,"dxi-column",27)(39,"dxi-column",28),r()(),M()),e&2&&(i(),o("sizeIcon",25),i(2),o("formGroup",t.courseForm),i(8),v("value",t.hasLimit),o("elementAttr",u(23,ee)),i(),o("showSpinButtons",!0)("readOnly",!t.hasLimit)("inputAttr",u(24,Ee)),i(5),v("value",t.hasPreviewCourse),o("elementAttr",u(25,ee)),i(),o("items",t.coursesSource)("searchEnabled",!0)("readOnly",!t.hasPreviewCourse)("inputAttr",u(26,Be)),i(2),o("width",120)("useSubmitBehavior",!0),i(5),o("elementAttr",u(27,ee)),i(2),o("dataSource",t.coursesSource),i(),o("visible",!0)("allowSearch",!1),i(),o("visible",!0),i(2),o("allowExportSelectedData",!0)("enabled",!0),i(5),o("dxTemplateOf","requisito"))},dependencies:[B,E,ae,O,T,P,N,I,k,A,Y,W,re,K,J,H,U,j,R,q,z,ce,G,de,L,se,V,Ce,ge],styles:[".form-course[_ngcontent-%COMP%]{width:100%;margin-top:1rem}.form-course[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;justify-items:center;align-items:center;margin-bottom:10px}.form-course[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .label-check[_ngcontent-%COMP%]{font-size:14px;margin-left:10px;width:22%}.form-course[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .dx-check[_ngcontent-%COMP%]{margin-left:10px}.form-course[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:30%;justify-content:flex-end}"]})}}return m})();var Ae=()=>({"aria-label":"Checked"}),Oe=()=>({type:"fixedPoint",precision:2}),ye=(()=>{class m extends Z{constructor(a,e){super(),this.cursoService=a,this._alert=e,this.defaultDate=new Date,this.dataSourseCursos=[],this.setDataSourseCursos=[],this.yearsEscolar=[],this.disableButtonSave=!0,this.yearSearch=new Date().getFullYear(),this.matriculaDate=[],this.yearEscolar=[],this.estadoMatricula=[{id:!0,name:"Abierta"},{id:!1,name:"Cerrada"}],this.fb=x(f),this.fb2=x(f),this.matriculaForm=x(f).group({id:new s(0),name:new s("",[D.required]),isOpen:new s(!0),isActive:new s(!0),yearEscolar:new s(null,[D.required]),yearEscolarDates:this.fb.group({dateInit:new s(new Date),dateEnd:new s(new Date)}),dateRange:this.fb2.group({dateInit:new s(new Date),dateEnd:new s(new Date)}),grados:new s([])})}ngOnInit(){this.cursoService.getCourses().then(a=>{this.dataSourseCursos=a.data}),this.getCurrentAndNextYear()}generateMatricula(){this.setDataSourseCursos=this.dataSourseCursos,this.disableButtonSave=!1}currentValueChanged(a,e){let[t,l]=a.value;this.matriculaForm.patchValue({[e]:{dateInit:t,dateEnd:l}})}onSaveClick(){return h(this,null,function*(){if(!this.matriculaForm.valid)return;if(this.setDataSourseCursos.some(l=>l.precio===0||l.precio===void 0||l.precio===null)){this._alert.warning("Datos Incompletos","Debe completar la informaci\xF3n de los grados");return}this.matriculaForm.patchValue({grados:this.setDataSourseCursos});let e=this.matriculaForm.value,t=e.id===0?this.cursoService.postMatricula(e):this.cursoService.putMatricula(e);this._alert.loading("Procesando..."),yield t.then(l=>{this._alert.close()}).catch(l=>{this._alert.warning("Ocurrio un erro al procesar","Error")})})}getCurrentAndNextYear(){let a=new Date().getFullYear(),e=a+1;this.yearsEscolar=[a,e]}findByYear(){return h(this,null,function*(){this._alert.loading("Cargando..."),yield this.cursoService.getMatriculaDefinicion(this.yearSearch).then(a=>{let e=a.data;this.matriculaForm.patchValue({id:e.id,name:e.name,isOpen:e.isOpen,yearEscolar:e.yearEscolar,isActive:e.isActive}),this.setDataSourseCursos=e.grados,this.matriculaDate=[e.dateRange.dateInit,e.dateRange.dateEnd],this.yearEscolar=[e.yearEscolarDates.dateInit,e.yearEscolarDates.dateEnd]}),this._alert.close()})}onToolbarPreparing(a){let{items:e}=a.toolbarOptions,t={location:"after",widget:"dxButton",options:{icon:"save",text:"Guardar",hint:"Guardar",type:"normal",elementAttr:{id:"agregarRegistros"},stylingMode:"contained",onClick:()=>this.onSaveClick()}},l={location:"after",widget:"dxButton",options:{icon:"inserttable",text:"Generar",hint:"Generar",type:"normal",elementAttr:{id:"agregarRegistros"},stylingMode:"contained",onClick:()=>this.generateMatricula()}};e.unshift(l,t)}static{this.\u0275fac=function(e){return new(e||m)(g(Q),g(X))}}static{this.\u0275cmp=_({type:m,selectors:[["app-matricula-definicion"]],standalone:!0,features:[b,F],decls:28,vars:20,consts:[["icon","bookmarks","title","Definici\xF3n matr\xEDculas",3,"sizeIcon"],[1,"form"],[3,"formGroup"],[1,"row"],["stylingMode","outlined","labelMode","floating","label","Buscar por a\xF1o","type","number",2,"width","25%",3,"valueChange","value"],["icon","search",2,"width","30px","height","30px","margin-top","5px",3,"onClick"],["stylingMode","outlined","labelMode","floating","label","Nombre Matr\xEDcula","formControlName","name",2,"width","25%"],["stylingMode","outlined","labelMode","floating","formGroupName","dateRange","startDateLabel","Fecha Inicio","endDateLabel","Fecha Final","displayFormat","dd/MM/yyyy",2,"margin-top","5px","width","50%","margin-left","10px",3,"onValueChanged","value"],["placeholder","A\xF1o escolar","formControlName","yearEscolar","label","A\xF1o escolar",2,"width","25%",3,"items"],["stylingMode","outlined","labelMode","floating","startDateLabel","Fecha Inicio","endDateLabel","Fecha Final","displayFormat","dd/MM/yyyy",2,"margin-top","5px","width","50%","margin-left","10px",3,"onValueChanged","value"],["placeholder","Estado","formControlName","isOpen","displayExpr","name","valueExpr","id","label","Estado",2,"width","25%",3,"items"],[2,"margin-left","10px"],[1,"dx-check"],["formControlName","isActive",2,"margin-left","10px",3,"elementAttr"],[3,"onToolbarPreparing","dataSource"],["mode","row",3,"allowUpdating","useIcons"],["mode","virtual"],["fileName","fileName",3,"allowExportSelectedData","enabled"],["dataField","courseName","dataType","string","caption","Nombre",3,"allowEditing"],["dataField","courseDescription","dataType","string","caption","Descripci\xF3n",3,"allowEditing"],["dataField","limit","dataType","string","caption","Limite","width","80",3,"allowEditing"],["dataField","precio","dataType","number","caption","Precio",3,"format","customizeText"]],template:function(e,t){e&1&&(S(0),c(1,"app-container",0),n(2,"div",1)(3,"form",2)(4,"div",3)(5,"dx-number-box",4),w("valueChange",function(d){return y(t.yearSearch,d)||(t.yearSearch=d),d}),r(),n(6,"dx-button",5),p("onClick",function(){return t.findByYear()}),r()(),n(7,"div",3),c(8,"dx-text-box",6),n(9,"dx-date-range-box",7),p("onValueChanged",function(d){return t.currentValueChanged(d,"dateRange")}),r()(),n(10,"div",3),c(11,"dx-select-box",8),n(12,"dx-date-range-box",9),p("onValueChanged",function(d){return t.currentValueChanged(d,"yearEscolarDates")}),r()(),n(13,"div",3),c(14,"dx-select-box",10),n(15,"div",11),C(16,"\xBFActivo?"),r(),n(17,"div",12),c(18,"dx-check-box",13),r()(),n(19,"div",3)(20,"dx-data-grid",14),p("onToolbarPreparing",function(d){return t.onToolbarPreparing(d)}),c(21,"dxo-editing",15)(22,"dxo-scrolling",16)(23,"dxo-export",17)(24,"dxi-column",18)(25,"dxi-column",19)(26,"dxi-column",20)(27,"dxi-column",21),r()()()(),M()),e&2&&(i(),o("sizeIcon",25),i(2),o("formGroup",t.matriculaForm),i(2),v("value",t.yearSearch),i(4),o("value",t.matriculaDate),i(2),o("items",t.yearsEscolar),i(),o("value",t.yearEscolar),i(2),o("items",t.estadoMatricula),i(4),o("elementAttr",u(18,Ae)),i(2),o("dataSource",t.setDataSourseCursos),i(),o("allowUpdating",!0)("useIcons",!0),i(2),o("allowExportSelectedData",!0)("enabled",!0),i(),o("allowEditing",!1),i(),o("allowEditing",!1),i(),o("allowEditing",!1),i(),o("format",u(19,Oe))("customizeText",t.formatCurrency))},dependencies:[B,E,O,T,P,N,I,k,A,ne,Y,W,K,J,H,U,j,R,q,z,G,le,L,V,me,fe,pe,ue,xe,he],styles:[".form[_ngcontent-%COMP%]{width:100%;margin-top:1rem}.form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;justify-items:center;align-items:center;margin-bottom:10px}.form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:80%;justify-content:flex-end}"]})}}return m})();var at=[{path:"",children:[{path:"grades",component:ve},{path:"matricula",component:ye}]}];export{at as CoursesRoutes};
